// Generate with
// flatc --scoped-enums --reflect-names --gen-mutable -c noodles_client.fbs

include "noodles.fbs";

namespace noodles;

// Client Messages =============================================================

table IntroductionMessage {
    client_name : string (required);
    version : uint32 = 0;
}

table MethodInvokeMessage {
    method_id : MethodID (required);

    // if any of the below is not set, it is on the document
    on_object : ObjectID;
    on_table  : TableID;
    on_plot   : PlotID;

    invoke_ident : string (required);
    method_args  : AnyList;
}

table AssetRefreshMessage {
    for_buffers : [ BufferID ] (required);
}

union ClientMessageType {
    IntroductionMessage,
    MethodInvokeMessage,
    AssetRefreshMessage
}

table ClientMessage {
    content : ClientMessageType (required);
}

table ClientMessages {
    messages : [ ClientMessage ] (required);
}

root_type ClientMessages;
